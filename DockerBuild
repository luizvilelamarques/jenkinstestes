class Docker {

	def app
	def server
	def image
	def registry
	def secret
	def isLatest
	def branch
	
	def DockerBuild(){
	    docker.withServer(server, '') {
		app = docker.build(imagemDocker())
	    }
	}

	def DockerPush(){
	    docker.withServer(server,'') {
		docker.withRegistry(registry, secret) {
		    app.push()
		}
	     }
	}

	def imagemDocker(){
	    if (isLatest){
		return "registry.intra.tjmg.gov.br/${image}:latest"
	    }
	    return "registry.intra.tjmg.gov.br/${image}:${branch}"
	} 
}

def instancia(dockerInfo, image, latest, branch){
   return new Docker(server: dockerInfo.server.url, 
   			image: img, 
			registry: dockerInfo.server.registry.url, 
			secret: dockerInfo.server.registry.secret, 
			isLatest: latest,
			branch: branch)
}

return this
